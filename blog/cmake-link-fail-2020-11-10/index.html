<!doctype html><html lang=en-us><head><title>Cmake Link Failed on Mac OS X | jw910731's Blog</title><meta charset=utf-8><meta name=language content="en"><meta name=description content="Cmake在"><meta name=keywords content><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><link rel="shortcut icon" type=image/png href=/favicon.ico><link type=text/css rel=stylesheet href=/css/post.min.2cb93c91050d1853bf971cc31e00122edd6e0f405aa1de3b7f8ef67ea3b5a79a.css integrity="sha256-LLk8kQUNGFO/lxzDHgASLt1uD0Baod47f472fqO1p5o="><link type=text/css rel=stylesheet href=/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.jw910731.wtf\/"},"articleSection":"blog","name":"Cmake Link Failed on Mac OS X","headline":"Cmake Link Failed on Mac OS X","description":"Cmake在","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2020","datePublished":"2020-11-10 00:44:37 \u002b0800 \u002b0800","dateModified":"2020-11-10 00:44:37 \u002b0800 \u002b0800","url":"https:\/\/blog.jw910731.wtf\/blog\/cmake-link-fail-2020-11-10\/","wordCount":"97","keywords":["Blog"]}</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-178403196-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=/>about</a></li><li><a class=active href=/blog>blog</a></li><li><a href=/course>course</a></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>Cmake Link Failed on Mac OS X</h1><time datetime="2020-11-10 00:44:37 +0800 +0800" class=post__date>Nov 10 2020</time></header><article class=post__content><h1 id=info>Info</h1><ul><li>Cmake : ver. 3.18.4</li><li>Mac OS X : ver. 10.15.7</li></ul><h1 id=事件>事件</h1><p>我最近開了個 Side Project ，但他的 Cmake 組建系統在 Mac OS X 上一直無法成功組建，錯誤訊息都是在連結時<code>ranlib</code>報告說發現某個特定的 Object File 中沒有 Symbol 。</p><p>一開始我便換了個平台 ( Linux 系統 ) 做組建，可以成功組建，因此我便往「 Cmake 與 Mac OS X 自帶的 Tool Chain 會有衝突」這個方向研究，事實上有找到不少資料都產生了與我類似的問題，但都沒有幫助。找到比較有關的是說在 Mac 上多執行緒的組建有蟲，沒辦法正確做 Linking ，但我試著將組建系統單執行緒化也仍然會有這個問題。</p><p>後來我轉而往我手上有的材料做調查，我細心地看了每個 Cmake 產出來的 Makefile 並了解他的架構，然後找到各個編譯出來的 Object File 做<code>objdump</code>。發現那個被<code>ranlib</code>報錯的 Object File 確實沒有 Symbol ，我一氣之下便用 ( 真的 ) gcc 來手動編譯這個檔案，卻發現我仍然得到沒有 Symbol 的 Object File ，心頭一震，我突然覺得應該是我的 Source FIle 寫爛了。</p><p>稍做比對後，我發現其他沒有報錯的檔案都沒有使用 C++ 的<code>template</code>，我往這個方向Google，果然就找到這篇<a href=https://stackoverflow.com/questions/13269116/template-classes-multiple-file-project-how-to>StackOverFlow</a>了。我犯蠢把含有<code>template</code>的實作封裝在 source file 裡面，這會導致以編譯時期為運作基礎的模版系統無法正確運作，才會導致我一直在連結階段找不到 Symbol 。</p><h1 id=後記與小結>後記與小結</h1><p>以後 C++ 寫到 Template 時要特別注意，不可以把含有 Template 的函數實作寫在<code>cpp</code> source file 裡面封裝，不然會導致 template 系統無法正確在編譯時期運作，進而導致在連結時期出錯！</p><p>果然任何程式語言要能夠稱作母語果然要至少有寫專案的經驗才算！在跨平台程式在撰寫時，如果不能考慮各種平台的狀況，也至少也要能在多幾種的平台上做過測試才行呢。</p><p>希望之後可以研究出到底為什麼在 Linux 上這樣不符合標準的程式怎麼可以成功組建！</p></article><ul class=tags__list><li class=tag__item><a class=tag__link href=https://blog.jw910731.wtf/tags/%E4%BA%8B%E4%BB%B6/>事件</a></li><li class=tag__item><a class=tag__link href=https://blog.jw910731.wtf/tags/cpp/>cpp</a></li><li class=tag__item><a class=tag__link href=https://blog.jw910731.wtf/tags/cmake/>cmake</a></li></ul><div class=pagination><a class=pagination__item href=https://blog.jw910731.wtf/blog/competitive-prog-icpc-singapore-2015-sim/><span class=pagination__label>Previous Post</span>
<span class=pagination__title>ICPC Singapore 2015 Regional 模擬賽心得</span></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link title=GitHub href=https://github.com/jw910731 target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://blog.jw910731.wtf/svg/github.svg)></div></a><a class=social-icons__link title=Gitlab href=https://gitlab.com/jw910731 target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://blog.jw910731.wtf/svg/gitlab.svg)></div></a><a class=social-icons__link title=Email href=mailto:jw910731@gmail.com target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://blog.jw910731.wtf/svg/email.svg)></div></a></div><p>jw910731© 2020</p></footer></div></div></div></main><script src=/js/index.min.49e4d8a384357d9b445b87371863419937ede9fa77737522ffb633073aebfa44.js integrity="sha256-SeTYo4Q1fZtEW4c3GGNBmTft6fp3c3Ui/7YzBzrr+kQ=" crossorigin=anonymous></script><script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script><script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script></body></html>